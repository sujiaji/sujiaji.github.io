<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> How to fit a manifold? | Jiaji Su </title> <meta name="author" content="Jiaji Su"> <meta name="description" content="why we can 'fit' a manifold?"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/nus-logo.png?e4e4b41f7d783e5de4f7c248550b6d42"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://sujiaji.github.io/blog/2024/mf-2/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Jiaji</span> Su </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">Profile </a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">Research </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">How to fit a manifold?</h1> <p class="post-meta"> October 25, 2024 </p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/manifold-fitting"> <i class="fa-solid fa-hashtag fa-sm"></i> manifold-fitting</a>   <a href="/blog/tag/ideas"> <i class="fa-solid fa-hashtag fa-sm"></i> ideas</a>     ·   <a href="/blog/category/manifold-fitting"> <i class="fa-solid fa-tag fa-sm"></i> manifold-fitting</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>This is a quick introduction of manifold fitting. A <a href="/assets/pdf/Quick_Notes_on_Manifold_Fitting.pdf">PDF version</a> is also available. More details can be found in:</p> <ul> <li>Fefferman, C., Ivanov, S., Kurylev, Y., Lassas, M., &amp; Narayanan, H. (2018, July). <a href="https://proceedings.mlr.press/v75/fefferman18a.html" rel="external nofollow noopener" target="_blank">Fitting a putative manifold to noisy data</a>. <em>In Conference On Learning Theory</em> (pp. 688-720). PMLR.</li> <li>Yao, Z., &amp; Xia, Y. (2019). <a href="https://arxiv.org/abs/1909.10228" rel="external nofollow noopener" target="_blank">Manifold fitting under unbounded noise</a>. <em>arXiv preprint arXiv:1909.10228</em>.</li> <li>Yao, Z., Su, J., Li, B., &amp; Yau, S. T. (2023). <a href="https://arxiv.org/abs/2304.07680" rel="external nofollow noopener" target="_blank">Manifold fitting</a>. <em>arXiv preprint arXiv:2304.07680</em>.</li> </ul> <h3 id="method">Method</h3> <p>Let \(z\) be the point of interest, which is close to \(\mathcal{M}\), and \(z^* = \arg\min_{z^\prime\in\mathcal{M}} d(z^\prime,z)\) be the projection of \(z\) on \(\mathcal{M}\). Intuitively, the estimation of manifold can be viewed as ‘‘pushing’’ \(z\) to \(z^*\).</p> <div style="text-align: center;"> <img src="/assets/img/mf-pics/push.png" alt="Push" style="max-width: 60%; height: auto;"> </div> <p>This pushing process involves two key components: direction and distance. The direction should be perpendicular to \(T_{z*}\mathcal{M}\), which can be deduced from the local ‘‘covariance’’ structure, while the distance \(d(z,\mathcal{M})\) might be estimated using the local average. The following subsections will introduce some intuitive concepts related to this process. For more details, please refer to the papers mentioned previously.</p> <h4 id="estimate-direction-from-local-covariance">Estimate Direction from Local ‘‘Covariance’’</h4> <p>For each point \(y_i\in\mathcal{Y}_N\), let \(y_i^*\) be its projection on \(\mathcal{M}\). Assume the normal space of \(\mathcal{M}\) at \(y_i^*\) has orthonormal basis \(\{u_1,\dots,u_{D-d}\}\), we use</p> \[\Pi_{y_i^*}^\perp = \bigl(u_1,\dots,u_{D-d}\bigl) \bigl(u_1,\dots,u_{D-d}\bigl)^\top = \sum_{k=1}^{D-d} u_k u_k^\top\] <p>to represent the projection matrix onto this space. This projection matrix can be estimated from the local variation centered at \(y_i\), and the estimator of \(\Pi_{y_i^*}^\perp\) is denoted as \(\widehat{\Pi}_{y_i}^\perp\).</p> <div style="text-align: center;"> <img src="/assets/img/mf-pics/local-cov.png" alt="Local Covariance" style="max-width: 60%; height: auto;"> </div> <p>Let \(\mathcal{B}_D(y_i,r)\) be the \(D\)-dimensional Euclidean ball centered at \(y_i\) with radius \(r\). If \(r\) is ‘‘large’’ enough, such that \(\|y_i - y_i^*\| \leq \|\xi_i\|\leq c_0r\), the area of \(\mathcal{B}_D(y_i,r)\cap \mathcal{M}\) roughly has radius \(c_1 r\), and the variation of \(\mathcal{M}\) along the normal direction is less than \(c_2 r^2\) due to the reach. Then, since the distribution of \(X\) is smooth, the variation of \(Y-y_i\) along direction:</p> <ul> <li>\(\leftrightarrow\): is roughly in the order of \((c_1 r)^2 + \sigma^2\);</li> <li>\(\updownarrow\): is roughly bounded above by the order of \((c_2 r^2)^2 + \sigma^2\).</li> </ul> <p>Thus, we can define</p> \[\widehat\Sigma_{r,i} = \frac{\sum_{j=1}^N (y_j-y_i)(y_j-y_i)^\top \mathbb{I}(\|y_j-y_i\|\leq r)}{\sum_{j=1}^n \mathbb{I}(\|y_j-y_i\|\leq r)}.\] <p>Then perform SVD on \(\widehat\Sigma_{r,i}\) to obtain \(\{\lambda_1&lt;\cdots&lt;\lambda_D\}\) and \(\{v_1,\dots,v_D\}\), and estimate \(\Pi_{y_i^*}^\perp\) with \(\widehat{\Pi}_{y_i}^\perp = \bigl(v_1,\dots,v_{D-d}\bigl) \bigl(v_1,\dots,v_{D-d}\bigl)^\top = \sum_{k=1}^{D-d} v_k v_k^\top,\) whose estimation error can be bounded.</p> <h4 id="smoothing-system">Smoothing System</h4> <p>To make the overall estimation smooth enough, the weight function for \(y_i\) with respect to \(z\) is defined as</p> \[\widetilde{\alpha}_i(z)=\left(1 - \frac{\|z - y_i\|^2}{r^{\prime 2}}\right)^{\beta} \mathbb{I}(\|z-y_i\|\leq r^\prime), \quad \alpha_i(z) = \frac{\widetilde{\alpha}_i(z)}{\sum_{i=1}^n\widetilde{\alpha}_i(z)},\] <p>where \(\beta\geq 2\) is a parameter corresponding to the smoothness. Then, for \(z\), a smooth reference point can be given by \(\widehat{\mu}_z = \sum_{i=1}^N \alpha_i(z) y_i\), and a smooth projection matrix is calculated as</p> \[\Psi_z = \mathbb{P}_{D-d}\left(\sum_{i=1}^N\alpha_i(z)\widehat\Pi_{y_i}^\perp\right),\] <p>where \(\mathbb{P}_{k} (A)\) stands for the projection of matrix \(A\) onto the span space corresponding to its largest \(k\) eigenvalues.</p> <h4 id="the-manifold-estimator">The Manifold Estimator</h4> <p>The vector from \(z^*\) to \(z\) can be estimated with the bias vector</p> \[\widehat{b}(z) = \sum_{i=1}^n \alpha_i(z)\Psi_z (z - y_i) = \Psi_z (z - \widehat{\mu}_z),\] <p>which can be shown</p> <ul> <li>\(\|\widehat{b}(z)\|\) close to \(\|z-z^*\|\);</li> <li>Jacobian matrix of \(\widehat{b}(z)\) is close to \(\Phi_z\), i.e. \(\|J_b(z) - \Psi_z\| \leq C\sigma/r^\prime + o_p(1)\);</li> <li>Hessian matrix of \(\widehat{b}(z)\) is lower bounded.</li> </ul> <div style="text-align: center;"> <img src="/assets/img/mf-pics/bias-vec.png" alt="Bias Vector" style="max-width: 80%; height: auto;"> </div> <p>Finally, the manifold estimator is given by</p> \[\widehat{\mathcal{M}} = \{z\in\mathbb{R}^D: d(z,\mathcal{M})&lt;cr^\prime, \widehat{b}(z) = 0\}.\] <p>Under all the error bounds and all the smoothness, for any \(z^\prime\in\widehat{\mathcal{M}}\), with high probability,</p> <ul> <li>\(z^\prime\) is close to \(\mathcal{M}\);</li> <li>in its neighborhood, \(\widehat{b}(z)\) is rank \(D-d\).</li> </ul> <p>Hence, with high probability, \(\widehat{\mathcal{M}}\) is a \(d\)-dimension manifold, close to \(\mathcal{M}\), and its reach can be bounded via the Hessian of \(\widehat{b}(z)\).</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/mf/">What is manifold fitting?</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Jiaji Su. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> based on <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>.<a href="https://clustrmaps.com/site/1bydk" title="Visit tracker" rel="external nofollow noopener" target="_blank"><img src="//clustrmaps.com/map_v2.png?cl=ffffff&amp;w=1&amp;t=n&amp;d=Bjt2TmKBrUaeSKCU4fyrlMr-IuQ_DhmG5AmSCNcuXig" width="1" height="1"></a> Last updated: July 10, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?fcfacfb8c6281f5e68d5a7d348186eb1"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>